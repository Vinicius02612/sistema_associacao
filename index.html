<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
  <title>Document</title>
  <style>
    /*Estilos para a página de produto*/
    .produto h1 {
      text-align: center;
      margin-bottom: 2rem;
    }

    .produto {
      margin-top: 5rem;
      width: 100%;
      height: 70vh;
      text-align: center;
      display: block;
    }

    .produto-content {
      margin: 8% 5%;
      display: flex;
      justify-content: space-around;
      align-items: center;
      flex-wrap: nowrap;
    }

    .produto-container {
      width: 15rem;
      background-color: #F7F7F7;
      margin-top: 2rem;
      flex: 0 0 calc(25% - 2rem);
      margin: 1rem;
      padding: 1rem;
      box-shadow: 2px 8px 16px 0 rgba(0, 0, 0, 0.375);
      transition: opacity 0.5s ease;
      border-radius: 1rem;
    }

    .carrossel-containerP {
      display: flex;
      overflow: hidden;
      scroll-behavior: smooth;
      /*transition: transform 10s cubic-bezier(0.25, 1, 0.5, 1);*/
    }

    .carrossel-fada {
      opacity: 0.2; 
    }

    .produto-container:hover {
      box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
    }


    .produto-name {
      padding: 1rem 0;
    }

    .produto-name h4 {
      color: #010570;
      font-weight: bolder;
      font-size: x-large;
    }
    .equipe-img {
      padding-bottom: 1rem;
    }

    .equipe-img img {
      border-radius: 5%;
      width: 100%;
      height: 32vh;
    }
    .button {
      margin: 0;
      height: 10%;
      padding: 10px 15px;
      border: none;
      border-radius: 50%;
      background: #FFFFFF;
      color: black;
      cursor: pointer;
      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
      font-size: 1rem; 
      display: flex;
      justify-content: center;
      align-items: center;

    }

    .button:disabled {
      background: #ccc;
      cursor: not-allowed;
      visibility: hidden;
    }
    .servicos-vermais {
      display: flex;
      justify-content: center;
    }

    .servicos-vermais button {
      padding: 0.2rem 2.2rem;
      border-radius: 1rem;
      background-color: #010570; 
      color: white; 
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <div id="produto" class="produto">
    <div class="produto-content">
      <button id="prevP" class="button"><i class="fas fa-chevron-left"></i></button>
      <div class="carrossel-containerP">
        <div class="produto-container">
          <div class="equipe-img">
            <img src="./core/templates/static/imgs/quilombo1.jpg" alt="imagem">
          </div>
          <div class="servicos-vermais">
            <button>Ver mais</button>
          </div>
        </div>
        <div class="produto-container">
          <div class="equipe-img">
            <img src="./core/templates/static/imgs/Rectangle 389.png" alt="imagem">
          </div>
          <div class="servicos-vermais">
            <button>Ver mais</button>
          </div>
        </div>
        <div class="produto-container">
          
          <div class="equipe-img">
            <img src="./core/templates/static/imgs/quilombo4.jpg" alt="imagem">
          </div>
          <div class="servicos-vermais">
            <button>Ver mais</button>
          </div>
        </div>
        <div class="produto-container">
          
          <div class="equipe-img">
            <img src="./core/templates/static/imgs/quilombo3.jpg" alt="imagem">
          </div>
          <div class="servicos-vermais">
            <button>Ver mais</button>
          </div>
        </div>
        <div class="produto-container">
          <div class="equipe-img">
            <img src="./core/templates/static/imgs/quilombo2.jpg" alt="imagem">
          </div>
          <div class="servicos-vermais">
            <button>Ver mais</button>
          </div>
        </div>   
        <div class="produto-container">
          <div class="equipe-img">
            <img src="./core/templates/static/imgs/quilombo1.jpg" alt="imagem">
          </div>
          <div class="servicos-vermais">
            <button>Ver mais</button>
          </div>
        </div>     
      </div>
      <button id="nextP" class="button"><i class="fas fa-chevron-right"></i></button>
    </div> 
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const carrosselContainer = document.querySelector('.carrossel-containerP');
      const nextButton = document.getElementById('nextP');
      const prevButton = document.getElementById('prevP');

      // Calcula a largura de um card incluindo margens
      const card = document.querySelector('.produto-container');
      const cardMargin = parseInt(getComputedStyle(card).marginRight);
      const cardWidth = card.clientWidth + cardMargin;

      let currentIndex = 0; // Índice do primeiro card visível

      const updateVisibleCards = () => {
        // Verifica a largura da tela e ajusta os cards visíveis
        return window.innerWidth < 768 ? 1 : Math.floor(carrosselContainer.clientWidth / cardWidth);
      };

      const updateVisible2Cards = () => {
        // Se a largura da tela for menor que 860px, exibir 2 cartões
        return window.innerWidth < 860 ? 2 : Math.floor(carrosselContainer.clientWidth / cardWidth);
      };

      let visibleCards = updateVisibleCards(); // Atualiza com base na largura da tela

      const updateButtons = () => {
        // Determina o índice máximo do primeiro card que pode ser mostrado
        const maxIndex = Math.floor((carrosselContainer.scrollWidth - carrosselContainer.clientWidth) / cardWidth);

        // Atualiza o estado dos botões
        prevButton.disabled = currentIndex <= 0;
        nextButton.disabled = currentIndex >= maxIndex;
      };

      const moveCarrossel = (direction) => {
        if (window.innerWidth < 768) {
          visibleCards = updateVisibleCards(); // Atualiza os cards visíveis
          let step = visibleCards;

          if (window.innerWidth < 700) {
            step = (visibleCards + 0.03);
          }
          if (window.innerWidth < 600) {
            step = (visibleCards + 0.04);
          }
          if (window.innerWidth < 500) {
            step = (visibleCards + 0.055);
          }
          if (window.innerWidth < 400) {
            step = (visibleCards + 0.065);
          }

          if (direction === 'nextP' && currentIndex < Math.floor((carrosselContainer.scrollWidth - carrosselContainer.clientWidth) / cardWidth)) {
            currentIndex += step; // Pula pelo número de cards visíveis
          } else if (direction === 'prevP' && currentIndex > 0) {
            currentIndex -= step; // Pula para trás pelo número de cards visíveis
          }
        }
        else if (window.innerWidth < 860) {
          visibleCards = updateVisible2Cards(); // Atualiza os cards visíveis
          let step = (visibleCards + 0.1);
          if (direction === 'nextP' && currentIndex < Math.floor((carrosselContainer.scrollWidth - carrosselContainer.clientWidth) / cardWidth)) {
            currentIndex += step; // Pula pelo número de cards visíveis
          } else if (direction === 'prevP' && currentIndex > 0) {
            currentIndex -= step; // Pula para trás pelo número de cards visíveis
          }
        } else {
          visibleCards = updateVisibleCards(); // Atualiza os cards visíveis
          let step = visibleCards;
          if (direction === 'nextP' && currentIndex < Math.floor((carrosselContainer.scrollWidth - carrosselContainer.clientWidth) / cardWidth)) {
            currentIndex += step; // Pula pelo número de cards visíveis
          } else if (direction === 'prevP' && currentIndex > 0) {
            currentIndex -= step; // Pula para trás pelo número de cards visíveis
          } 
        }

        // Move o carrossel para a posição correta
        carrosselContainer.scrollLeft = currentIndex * cardWidth;

        updateButtons(); // Atualiza o estado dos botões
      };

      // Adiciona eventos aos botões
      nextButton.addEventListener('click', () => moveCarrossel('nextP'));
      prevButton.addEventListener('click', () => moveCarrossel('prevP'));

      updateButtons(); // Atualiza inicialmente os botões
    });
  </script>
</body>
</html>